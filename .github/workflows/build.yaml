name: Arduino and C# CI

on: [push, pull_request]

jobs:
  build-arduino:
    runs-on: ubuntu-latest
    steps:
    - name: Check out repository
      uses: actions/checkout@v2

    - name: Set up Arduino CLI
      uses: arduino/setup-arduino-cli@v1
      with:
        version: latest

    - name: Compile Arduino Code
      run: |
        arduino-cli core update-index
        arduino-cli core install arduino:avr
        arduino-cli compile --fqbn arduino:avr:uno ../../Server/Server.ino

  build-csharp:
    runs-on: windows-latest
    steps:
    - name: Check out repository
      uses: actions/checkout@v2

    - name: Set up .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Restore dependencies
      run: dotnet restore ../../Client/Client.csproj

    - name: Build C# Client
      run: dotnet build ../../Client/Client.csproj --configuration Release
